"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/ncp/list/route";
exports.ids = ["app/api/ncp/list/route"];
exports.modules = {

/***/ "better-sqlite3":
/*!*********************************!*\
  !*** external "better-sqlite3" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("better-sqlite3");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fncp%2Flist%2Froute&page=%2Fapi%2Fncp%2Flist%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fncp%2Flist%2Froute.ts&appDir=%2Fhome%2Frunner%2Fworkspace%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Frunner%2Fworkspace&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fncp%2Flist%2Froute&page=%2Fapi%2Fncp%2Flist%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fncp%2Flist%2Froute.ts&appDir=%2Fhome%2Frunner%2Fworkspace%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Frunner%2Fworkspace&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _home_runner_workspace_app_api_ncp_list_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/ncp/list/route.ts */ \"(rsc)/./app/api/ncp/list/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/ncp/list/route\",\n        pathname: \"/api/ncp/list\",\n        filename: \"route\",\n        bundlePath: \"app/api/ncp/list/route\"\n    },\n    resolvedPagePath: \"/home/runner/workspace/app/api/ncp/list/route.ts\",\n    nextConfigOutput,\n    userland: _home_runner_workspace_app_api_ncp_list_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/ncp/list/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZuY3AlMkZsaXN0JTJGcm91dGUmcGFnZT0lMkZhcGklMkZuY3AlMkZsaXN0JTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGbmNwJTJGbGlzdCUyRnJvdXRlLnRzJmFwcERpcj0lMkZob21lJTJGcnVubmVyJTJGd29ya3NwYWNlJTJGYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj0lMkZob21lJTJGcnVubmVyJTJGd29ya3NwYWNlJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUNBO0FBQzdFO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlFO0FBQ3pFO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDdUg7O0FBRXZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbXktdjAtcHJvamVjdC8/YjJmMSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIvaG9tZS9ydW5uZXIvd29ya3NwYWNlL2FwcC9hcGkvbmNwL2xpc3Qvcm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL25jcC9saXN0L3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvbmNwL2xpc3RcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL25jcC9saXN0L3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS9hcHAvYXBpL25jcC9saXN0L3JvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9uY3AvbGlzdC9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fncp%2Flist%2Froute&page=%2Fapi%2Fncp%2Flist%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fncp%2Flist%2Froute.ts&appDir=%2Fhome%2Frunner%2Fworkspace%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Frunner%2Fworkspace&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/ncp/list/route.ts":
/*!***********************************!*\
  !*** ./app/api/ncp/list/route.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_database__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/database */ \"(rsc)/./lib/database.ts\");\n/* harmony import */ var _lib_auth__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/auth */ \"(rsc)/./lib/auth.ts\");\n\n\n\nasync function GET(request) {\n    try {\n        const user = await (0,_lib_auth__WEBPACK_IMPORTED_MODULE_2__.verifyAuth)(request);\n        if (!user) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Unauthorized\"\n            }, {\n                status: 401\n            });\n        }\n        const { searchParams } = new URL(request.url);\n        const type = searchParams.get(\"type\") || \"all\";\n        let reports;\n        if (type === \"pending\") {\n            reports = (0,_lib_database__WEBPACK_IMPORTED_MODULE_1__.getPendingNCPsForRole)(user.role, user.username);\n        } else {\n            reports = (0,_lib_database__WEBPACK_IMPORTED_MODULE_1__.getNCPReportsForUser)(user.id, user.role, user.username);\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            data: reports\n        });\n    } catch (error) {\n        console.error(\"Error fetching NCP reports:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Failed to fetch NCP reports\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL25jcC9saXN0L3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBNEQ7QUFDZ0I7QUFDckM7QUFFaEMsZUFBZUksSUFBSUMsT0FBb0I7SUFDNUMsSUFBSTtRQUNGLE1BQU1DLE9BQU8sTUFBTUgscURBQVVBLENBQUNFO1FBQzlCLElBQUksQ0FBQ0MsTUFBTTtZQUNULE9BQU9OLHFEQUFZQSxDQUFDTyxJQUFJLENBQUM7Z0JBQUVDLE9BQU87WUFBZSxHQUFHO2dCQUFFQyxRQUFRO1lBQUk7UUFDcEU7UUFFQSxNQUFNLEVBQUVDLFlBQVksRUFBRSxHQUFHLElBQUlDLElBQUlOLFFBQVFPLEdBQUc7UUFDNUMsTUFBTUMsT0FBT0gsYUFBYUksR0FBRyxDQUFDLFdBQVc7UUFFekMsSUFBSUM7UUFDSixJQUFJRixTQUFTLFdBQVc7WUFDdEJFLFVBQVViLG9FQUFxQkEsQ0FBQ0ksS0FBS1UsSUFBSSxFQUFFVixLQUFLVyxRQUFRO1FBQzFELE9BQU87WUFDTEYsVUFBVWQsbUVBQW9CQSxDQUFDSyxLQUFLWSxFQUFFLEVBQUVaLEtBQUtVLElBQUksRUFBRVYsS0FBS1csUUFBUTtRQUNsRTtRQUVBLE9BQU9qQixxREFBWUEsQ0FBQ08sSUFBSSxDQUFDO1lBQ3ZCWSxTQUFTO1lBQ1RDLE1BQU1MO1FBQ1I7SUFDRixFQUFFLE9BQU9QLE9BQU87UUFDZGEsUUFBUWIsS0FBSyxDQUFDLCtCQUErQkE7UUFDN0MsT0FBT1IscURBQVlBLENBQUNPLElBQUksQ0FBQztZQUFFQyxPQUFPO1FBQThCLEdBQUc7WUFBRUMsUUFBUTtRQUFJO0lBQ25GO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9teS12MC1wcm9qZWN0Ly4vYXBwL2FwaS9uY3AvbGlzdC9yb3V0ZS50cz9lNWJiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHR5cGUgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gXCJuZXh0L3NlcnZlclwiXG5pbXBvcnQgeyBnZXROQ1BSZXBvcnRzRm9yVXNlciwgZ2V0UGVuZGluZ05DUHNGb3JSb2xlIH0gZnJvbSBcIkAvbGliL2RhdGFiYXNlXCJcbmltcG9ydCB7IHZlcmlmeUF1dGggfSBmcm9tIFwiQC9saWIvYXV0aFwiXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgdmVyaWZ5QXV0aChyZXF1ZXN0KVxuICAgIGlmICghdXNlcikge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IFwiVW5hdXRob3JpemVkXCIgfSwgeyBzdGF0dXM6IDQwMSB9KVxuICAgIH1cblxuICAgIGNvbnN0IHsgc2VhcmNoUGFyYW1zIH0gPSBuZXcgVVJMKHJlcXVlc3QudXJsKVxuICAgIGNvbnN0IHR5cGUgPSBzZWFyY2hQYXJhbXMuZ2V0KFwidHlwZVwiKSB8fCBcImFsbFwiXG5cbiAgICBsZXQgcmVwb3J0c1xuICAgIGlmICh0eXBlID09PSBcInBlbmRpbmdcIikge1xuICAgICAgcmVwb3J0cyA9IGdldFBlbmRpbmdOQ1BzRm9yUm9sZSh1c2VyLnJvbGUsIHVzZXIudXNlcm5hbWUpXG4gICAgfSBlbHNlIHtcbiAgICAgIHJlcG9ydHMgPSBnZXROQ1BSZXBvcnRzRm9yVXNlcih1c2VyLmlkLCB1c2VyLnJvbGUsIHVzZXIudXNlcm5hbWUpXG4gICAgfVxuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBkYXRhOiByZXBvcnRzLFxuICAgIH0pXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkVycm9yIGZldGNoaW5nIE5DUCByZXBvcnRzOlwiLCBlcnJvcilcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogXCJGYWlsZWQgdG8gZmV0Y2ggTkNQIHJlcG9ydHNcIiB9LCB7IHN0YXR1czogNTAwIH0pXG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJnZXROQ1BSZXBvcnRzRm9yVXNlciIsImdldFBlbmRpbmdOQ1BzRm9yUm9sZSIsInZlcmlmeUF1dGgiLCJHRVQiLCJyZXF1ZXN0IiwidXNlciIsImpzb24iLCJlcnJvciIsInN0YXR1cyIsInNlYXJjaFBhcmFtcyIsIlVSTCIsInVybCIsInR5cGUiLCJnZXQiLCJyZXBvcnRzIiwicm9sZSIsInVzZXJuYW1lIiwiaWQiLCJzdWNjZXNzIiwiZGF0YSIsImNvbnNvbGUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/ncp/list/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/auth.ts":
/*!*********************!*\
  !*** ./lib/auth.ts ***!
  \*********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   verifyAuth: () => (/* binding */ verifyAuth)\n/* harmony export */ });\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/jose/dist/webapi/jwt/verify.js\");\n\nconst secret = new TextEncoder().encode(process.env.JWT_SECRET || \"your-secret-key\");\nasync function verifyAuth(request) {\n    try {\n        const token = request.cookies.get(\"auth-token\")?.value;\n        if (!token) {\n            return null;\n        }\n        const { payload } = await (0,jose__WEBPACK_IMPORTED_MODULE_0__.jwtVerify)(token, secret);\n        return {\n            id: payload.userId,\n            username: payload.username,\n            role: payload.role\n        };\n    } catch (error) {\n        console.error(\"Auth verification error:\", error);\n        return null;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvYXV0aC50cyIsIm1hcHBpbmdzIjoiOzs7OztBQUNnQztBQUVoQyxNQUFNQyxTQUFTLElBQUlDLGNBQWNDLE1BQU0sQ0FBQ0MsUUFBUUMsR0FBRyxDQUFDQyxVQUFVLElBQUk7QUFFM0QsZUFBZUMsV0FBV0MsT0FBb0I7SUFDbkQsSUFBSTtRQUNGLE1BQU1DLFFBQVFELFFBQVFFLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLGVBQWVDO1FBRWpELElBQUksQ0FBQ0gsT0FBTztZQUNWLE9BQU87UUFDVDtRQUVBLE1BQU0sRUFBRUksT0FBTyxFQUFFLEdBQUcsTUFBTWIsK0NBQVNBLENBQUNTLE9BQU9SO1FBRTNDLE9BQU87WUFDTGEsSUFBSUQsUUFBUUUsTUFBTTtZQUNsQkMsVUFBVUgsUUFBUUcsUUFBUTtZQUMxQkMsTUFBTUosUUFBUUksSUFBSTtRQUNwQjtJQUNGLEVBQUUsT0FBT0MsT0FBTztRQUNkQyxRQUFRRCxLQUFLLENBQUMsNEJBQTRCQTtRQUMxQyxPQUFPO0lBQ1Q7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL215LXYwLXByb2plY3QvLi9saWIvYXV0aC50cz9iZjdlIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHsgTmV4dFJlcXVlc3QgfSBmcm9tIFwibmV4dC9zZXJ2ZXJcIlxuaW1wb3J0IHsgand0VmVyaWZ5IH0gZnJvbSBcImpvc2VcIlxuXG5jb25zdCBzZWNyZXQgPSBuZXcgVGV4dEVuY29kZXIoKS5lbmNvZGUocHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCB8fCBcInlvdXItc2VjcmV0LWtleVwiKVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdmVyaWZ5QXV0aChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICB0cnkge1xuICAgIGNvbnN0IHRva2VuID0gcmVxdWVzdC5jb29raWVzLmdldChcImF1dGgtdG9rZW5cIik/LnZhbHVlXG5cbiAgICBpZiAoIXRva2VuKSB7XG4gICAgICByZXR1cm4gbnVsbFxuICAgIH1cblxuICAgIGNvbnN0IHsgcGF5bG9hZCB9ID0gYXdhaXQgand0VmVyaWZ5KHRva2VuLCBzZWNyZXQpXG5cbiAgICByZXR1cm4ge1xuICAgICAgaWQ6IHBheWxvYWQudXNlcklkIGFzIG51bWJlcixcbiAgICAgIHVzZXJuYW1lOiBwYXlsb2FkLnVzZXJuYW1lIGFzIHN0cmluZyxcbiAgICAgIHJvbGU6IHBheWxvYWQucm9sZSBhcyBzdHJpbmcsXG4gICAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJBdXRoIHZlcmlmaWNhdGlvbiBlcnJvcjpcIiwgZXJyb3IpXG4gICAgcmV0dXJuIG51bGxcbiAgfVxufVxuIl0sIm5hbWVzIjpbImp3dFZlcmlmeSIsInNlY3JldCIsIlRleHRFbmNvZGVyIiwiZW5jb2RlIiwicHJvY2VzcyIsImVudiIsIkpXVF9TRUNSRVQiLCJ2ZXJpZnlBdXRoIiwicmVxdWVzdCIsInRva2VuIiwiY29va2llcyIsImdldCIsInZhbHVlIiwicGF5bG9hZCIsImlkIiwidXNlcklkIiwidXNlcm5hbWUiLCJyb2xlIiwiZXJyb3IiLCJjb25zb2xlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/auth.ts\n");

/***/ }),

/***/ "(rsc)/./lib/database.ts":
/*!*************************!*\
  !*** ./lib/database.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   approveNCPByProcessLead: () => (/* binding */ approveNCPByProcessLead),\n/* harmony export */   approveNCPByQALeader: () => (/* binding */ approveNCPByQALeader),\n/* harmony export */   approveNCPByQAManager: () => (/* binding */ approveNCPByQAManager),\n/* harmony export */   authenticateUser: () => (/* binding */ authenticateUser),\n/* harmony export */   createNCPReport: () => (/* binding */ createNCPReport),\n/* harmony export */   createNotification: () => (/* binding */ createNotification),\n/* harmony export */   createNotificationForRole: () => (/* binding */ createNotificationForRole),\n/* harmony export */   db: () => (/* binding */ db),\n/* harmony export */   generateNCPNumber: () => (/* binding */ generateNCPNumber),\n/* harmony export */   getNCPById: () => (/* binding */ getNCPById),\n/* harmony export */   getNCPReportsForUser: () => (/* binding */ getNCPReportsForUser),\n/* harmony export */   getNCPStatistics: () => (/* binding */ getNCPStatistics),\n/* harmony export */   getNCPStatisticsForRole: () => (/* binding */ getNCPStatisticsForRole),\n/* harmony export */   getNotificationsForUser: () => (/* binding */ getNotificationsForUser),\n/* harmony export */   getPendingNCPsForRole: () => (/* binding */ getPendingNCPsForRole),\n/* harmony export */   getUnreadNotificationCount: () => (/* binding */ getUnreadNotificationCount),\n/* harmony export */   getUserByUsername: () => (/* binding */ getUserByUsername),\n/* harmony export */   initializeDatabase: () => (/* binding */ initializeDatabase),\n/* harmony export */   markAllNotificationsAsRead: () => (/* binding */ markAllNotificationsAsRead),\n/* harmony export */   markNotificationAsRead: () => (/* binding */ markNotificationAsRead),\n/* harmony export */   processNCPByTeamLeader: () => (/* binding */ processNCPByTeamLeader),\n/* harmony export */   rejectNCPByProcessLead: () => (/* binding */ rejectNCPByProcessLead),\n/* harmony export */   rejectNCPByQALeader: () => (/* binding */ rejectNCPByQALeader),\n/* harmony export */   rejectNCPByQAManager: () => (/* binding */ rejectNCPByQAManager),\n/* harmony export */   updateExistingRecords: () => (/* binding */ updateExistingRecords)\n/* harmony export */ });\n/* harmony import */ var better_sqlite3__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! better-sqlite3 */ \"better-sqlite3\");\n/* harmony import */ var better_sqlite3__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(better_sqlite3__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! bcryptjs */ \"(rsc)/./node_modules/bcryptjs/index.js\");\n\n\n// Database schema and connection\nconst db = new (better_sqlite3__WEBPACK_IMPORTED_MODULE_0___default())(\"qa_portal.db\");\n// Initialize database tables (called only if tables don't exist)\nfunction initializeDatabase() {\n    // Check if tables exist\n    const tablesExist = db.prepare(\"SELECT name FROM sqlite_master WHERE type='table' AND name='users'\").get();\n    if (tablesExist) {\n        return;\n    }\n    // Users table\n    db.exec(`\n    CREATE TABLE IF NOT EXISTS users (\n      id INTEGER PRIMARY KEY AUTOINCREMENT,\n      username TEXT UNIQUE NOT NULL,\n      password TEXT NOT NULL,\n      role TEXT DEFAULT 'user',\n      full_name TEXT,\n      created_at DATETIME DEFAULT CURRENT_TIMESTAMP\n    )\n  `);\n    // NCP Reports table with extended fields for approval workflow\n    db.exec(`\n    CREATE TABLE IF NOT EXISTS ncp_reports (\n      id INTEGER PRIMARY KEY AUTOINCREMENT,\n      ncp_id TEXT UNIQUE NOT NULL,\n      sku_code TEXT NOT NULL,\n      machine_code TEXT NOT NULL,\n      date TEXT NOT NULL,\n      time_incident TEXT NOT NULL,\n      hold_quantity INTEGER NOT NULL,\n      hold_quantity_uom TEXT NOT NULL,\n      problem_description TEXT NOT NULL,\n      photo_attachment TEXT,\n      qa_leader TEXT NOT NULL,\n      status TEXT DEFAULT 'pending',\n      submitted_by TEXT NOT NULL,\n      submitted_at DATETIME DEFAULT CURRENT_TIMESTAMP,\n      \n      -- QA Leader Approval Fields\n      qa_approved_by TEXT,\n      qa_approved_at DATETIME,\n      disposisi TEXT,\n      jumlah_sortir TEXT DEFAULT '0',\n      jumlah_release TEXT DEFAULT '0',\n      jumlah_reject TEXT DEFAULT '0',\n      assigned_team_leader TEXT,\n      qa_rejection_reason TEXT,\n      \n      -- Team Leader Fields\n      tl_processed_by TEXT,\n      tl_processed_at DATETIME,\n      root_cause_analysis TEXT,\n      corrective_action TEXT,\n      preventive_action TEXT,\n      \n      -- Process Lead Fields\n      process_approved_by TEXT,\n      process_approved_at DATETIME,\n      process_rejection_reason TEXT,\n      process_comment TEXT,\n      \n      -- QA Manager Fields\n      manager_approved_by TEXT,\n      manager_approved_at DATETIME,\n      manager_rejection_reason TEXT,\n      manager_comment TEXT,\n      \n      -- Final status\n      archived_at DATETIME\n    )\n  `);\n    // Notifications table\n    db.exec(`\n    CREATE TABLE IF NOT EXISTS notifications (\n      id INTEGER PRIMARY KEY AUTOINCREMENT,\n      user_id INTEGER NOT NULL,\n      ncp_id TEXT NOT NULL,\n      title TEXT NOT NULL,\n      message TEXT NOT NULL,\n      type TEXT DEFAULT 'info',\n      is_read BOOLEAN DEFAULT FALSE,\n      created_at DATETIME DEFAULT CURRENT_TIMESTAMP,\n      FOREIGN KEY (user_id) REFERENCES users (id)\n    )\n  `);\n}\n// FIXED: Generate automatic NCP number with format YYMM-XXXX\nfunction generateNCPNumber() {\n    const now = new Date();\n    const year = now.getFullYear().toString().slice(-2);\n    const month = (now.getMonth() + 1).toString().padStart(2, \"0\");\n    // Get the latest serial number for current year\n    const latestRecord = db.prepare(`\n    SELECT ncp_id FROM ncp_reports \n    WHERE ncp_id LIKE ? \n    ORDER BY ncp_id DESC \n    LIMIT 1\n  `).get(`${year}${month}-%`);\n    let serialNumber = 1;\n    if (latestRecord) {\n        const existingSerial = latestRecord.ncp_id.split(\"-\")[1];\n        serialNumber = Number.parseInt(existingSerial) + 1;\n    }\n    const formattedSerial = serialNumber.toString().padStart(4, \"0\");\n    return `${year}${month}-${formattedSerial}`;\n}\n// FIXED: User authentication functions\nasync function authenticateUser(username, password) {\n    const user = db.prepare(\"SELECT * FROM users WHERE username = ?\").get(username);\n    if (!user) return null;\n    const isValid = await (0,bcryptjs__WEBPACK_IMPORTED_MODULE_1__.compare)(password, user.password);\n    if (!isValid) return null;\n    return {\n        id: user.id,\n        username: user.username,\n        role: user.role,\n        fullName: user.full_name\n    };\n}\n// Get user by username\nfunction getUserByUsername(username) {\n    return db.prepare(\"SELECT id, username, role, full_name FROM users WHERE username = ?\").get(username);\n}\n// FIXED: NCP Report functions\nfunction createNCPReport(data) {\n    const ncpId = generateNCPNumber();\n    const stmt = db.prepare(`\n    INSERT INTO ncp_reports (\n      ncp_id, sku_code, machine_code, date, time_incident,\n      hold_quantity, hold_quantity_uom, problem_description,\n      photo_attachment, qa_leader, submitted_by\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n  `);\n    const result = stmt.run(ncpId, data.skuCode, data.machineCode, data.date, data.timeIncident, data.holdQuantity, data.holdQuantityUOM, data.problemDescription, data.photoAttachment, data.qaLeader, data.submittedBy);\n    // Create notification for QA Leaders\n    createNotificationForRole(\"qa_leader\", ncpId, \"New NCP Submitted\", `NCP ${ncpId} requires your approval`);\n    return {\n        id: result.lastInsertRowid,\n        ncpId\n    };\n}\n// Get NCPs based on user role and permissions\nfunction getNCPReportsForUser(userId, userRole, username) {\n    let query = \"SELECT * FROM ncp_reports\";\n    let params = [];\n    switch(userRole){\n        case \"user\":\n            query += \" WHERE submitted_by = ? ORDER BY submitted_at DESC\";\n            params = [\n                username\n            ];\n            break;\n        case \"qa_leader\":\n            query += \" ORDER BY submitted_at DESC\";\n            break;\n        case \"team_leader\":\n            query += \" WHERE assigned_team_leader = ? ORDER BY submitted_at DESC\";\n            params = [\n                username\n            ];\n            break;\n        case \"process_lead\":\n            query += \" WHERE status IN ('tl_processed', 'process_approved', 'process_rejected') ORDER BY submitted_at DESC\";\n            break;\n        case \"qa_manager\":\n        case \"admin\":\n            query += \" ORDER BY submitted_at DESC\";\n            break;\n        default:\n            query += \" WHERE submitted_by = ? ORDER BY submitted_at DESC\";\n            params = [\n                username\n            ];\n    }\n    const results = db.prepare(query).all(...params);\n    return results;\n}\n// FIXED: Get pending NCPs for approval based on role\nfunction getPendingNCPsForRole(userRole, username) {\n    let query = \"\";\n    let params = [];\n    switch(userRole){\n        case \"qa_leader\":\n            query = \"SELECT * FROM ncp_reports WHERE status = 'pending' ORDER BY submitted_at ASC\";\n            break;\n        case \"team_leader\":\n            // FIXED: Show NCPs assigned to this team leader\n            query = `\n        SELECT * FROM ncp_reports \n        WHERE assigned_team_leader = ? \n        AND status IN ('qa_approved', 'tl_processed') \n        ORDER BY qa_approved_at ASC\n      `;\n            params = [\n                username\n            ];\n            break;\n        case \"process_lead\":\n            query = \"SELECT * FROM ncp_reports WHERE status = 'tl_processed' ORDER BY tl_processed_at ASC\";\n            break;\n        case \"qa_manager\":\n            query = \"SELECT * FROM ncp_reports WHERE status = 'process_approved' ORDER BY process_approved_at ASC\";\n            break;\n        default:\n            return [];\n    }\n    const results = db.prepare(query).all(...params);\n    return results;\n}\n// Get single NCP by ID\nfunction getNCPById(id) {\n    const result = db.prepare(\"SELECT * FROM ncp_reports WHERE id = ?\").get(id);\n    return result;\n}\n// FIXED: QA Leader approval - Proper data flow to Team Leader\nfunction approveNCPByQALeader(id, approvalData, qaLeaderUsername) {\n    const stmt = db.prepare(`\n    UPDATE ncp_reports \n    SET status = 'qa_approved',\n        qa_approved_by = ?,\n        qa_approved_at = CURRENT_TIMESTAMP,\n        disposisi = ?,\n        jumlah_sortir = ?,\n        jumlah_release = ?,\n        jumlah_reject = ?,\n        assigned_team_leader = ?\n    WHERE id = ?\n  `);\n    const result = stmt.run(qaLeaderUsername, approvalData.disposisi, approvalData.jumlahSortir || \"0\", approvalData.jumlahRelease || \"0\", approvalData.jumlahReject || \"0\", approvalData.assignedTeamLeader, id);\n    if (result.changes > 0) {\n        // Get NCP details for notification\n        const ncp = db.prepare(\"SELECT ncp_id FROM ncp_reports WHERE id = ?\").get(id);\n        // FIXED: Create notification for assigned team leader using the exact username\n        const teamLeaderUser = db.prepare(\"SELECT id FROM users WHERE username = ?\").get(approvalData.assignedTeamLeader);\n        if (teamLeaderUser) {\n            createNotification(teamLeaderUser.id, ncp.ncp_id, \"NCP Assigned to You\", `NCP ${ncp.ncp_id} has been approved by QA Leader and assigned to you for RCA analysis`);\n        }\n        // Also create notification for all team leaders as backup\n        createNotificationForRole(\"team_leader\", ncp.ncp_id, \"New NCP Assignment\", `NCP ${ncp.ncp_id} has been approved and assigned to ${approvalData.assignedTeamLeader}`);\n    }\n    return result;\n}\n// QA Leader rejection\nfunction rejectNCPByQALeader(id, rejectionReason, qaLeaderUsername) {\n    const stmt = db.prepare(`\n    UPDATE ncp_reports \n    SET status = 'qa_rejected',\n        qa_approved_by = ?,\n        qa_approved_at = CURRENT_TIMESTAMP,\n        qa_rejection_reason = ?\n    WHERE id = ?\n  `);\n    const result = stmt.run(qaLeaderUsername, rejectionReason, id);\n    return result;\n}\n// Team Leader processing\nfunction processNCPByTeamLeader(id, processData, teamLeaderUsername) {\n    const stmt = db.prepare(`\n    UPDATE ncp_reports \n    SET status = 'tl_processed',\n        tl_processed_by = ?,\n        tl_processed_at = CURRENT_TIMESTAMP,\n        root_cause_analysis = ?,\n        corrective_action = ?,\n        preventive_action = ?\n    WHERE id = ?\n  `);\n    const result = stmt.run(teamLeaderUsername, processData.rootCauseAnalysis, processData.correctiveAction, processData.preventiveAction, id);\n    if (result.changes > 0) {\n        // Get NCP details for notification\n        const ncp = db.prepare(\"SELECT ncp_id FROM ncp_reports WHERE id = ?\").get(id);\n        // Create notification for process leads\n        createNotificationForRole(\"process_lead\", ncp.ncp_id, \"NCP Ready for Process Review\", `NCP ${ncp.ncp_id} has been processed by Team Leader and requires process review`);\n    }\n    return result;\n}\n// Process Lead approval functions\nfunction approveNCPByProcessLead(id, comment, processLeadUsername) {\n    const stmt = db.prepare(`\n    UPDATE ncp_reports \n    SET status = 'process_approved',\n        process_approved_by = ?,\n        process_approved_at = CURRENT_TIMESTAMP,\n        process_comment = ?\n    WHERE id = ?\n  `);\n    const result = stmt.run(processLeadUsername, comment, id);\n    if (result.changes > 0) {\n        // Get NCP details for notification\n        const ncp = db.prepare(\"SELECT ncp_id FROM ncp_reports WHERE id = ?\").get(id);\n        // Create notification for QA Managers\n        createNotificationForRole(\"qa_manager\", ncp.ncp_id, \"NCP Ready for Final Approval\", `NCP ${ncp.ncp_id} has been approved by Process Lead and requires final QA Manager approval`);\n    }\n    return result;\n}\nfunction rejectNCPByProcessLead(id, rejectionReason, processLeadUsername) {\n    const stmt = db.prepare(`\n    UPDATE ncp_reports \n    SET status = 'qa_approved',\n        process_approved_by = ?,\n        process_approved_at = CURRENT_TIMESTAMP,\n        process_rejection_reason = ?\n    WHERE id = ?\n  `);\n    const result = stmt.run(processLeadUsername, rejectionReason, id);\n    if (result.changes > 0) {\n        // Get NCP details for notification\n        const ncp = db.prepare(\"SELECT ncp_id, assigned_team_leader FROM ncp_reports WHERE id = ?\").get(id);\n        // Create notification for assigned team leader\n        const teamLeaderUser = db.prepare(\"SELECT id FROM users WHERE username = ?\").get(ncp.assigned_team_leader);\n        if (teamLeaderUser) {\n            createNotification(teamLeaderUser.id, ncp.ncp_id, \"NCP Rejected by Process Lead\", `NCP ${ncp.ncp_id} has been rejected by Process Lead and returned for reprocessing. Reason: ${rejectionReason}`);\n        }\n    }\n    return result;\n}\n// QA Manager approval functions\nfunction approveNCPByQAManager(id, comment, qaManagerUsername) {\n    const stmt = db.prepare(`\n    UPDATE ncp_reports \n    SET status = 'manager_approved',\n        manager_approved_by = ?,\n        manager_approved_at = CURRENT_TIMESTAMP,\n        manager_comment = ?,\n        archived_at = CURRENT_TIMESTAMP\n    WHERE id = ?\n  `);\n    const result = stmt.run(qaManagerUsername, comment, id);\n    if (result.changes > 0) {\n        // Get NCP details for notification\n        const ncp = db.prepare(\"SELECT ncp_id, submitted_by FROM ncp_reports WHERE id = ?\").get(id);\n        // Create notification for original submitter\n        const submitterUser = db.prepare(\"SELECT id FROM users WHERE username = ?\").get(ncp.submitted_by);\n        if (submitterUser) {\n            createNotification(submitterUser.id, ncp.ncp_id, \"NCP Workflow Completed\", `NCP ${ncp.ncp_id} has been fully approved and archived. The workflow is now complete.`);\n        }\n        // Also notify QA Leader\n        const ncpDetails = db.prepare(\"SELECT qa_approved_by FROM ncp_reports WHERE id = ?\").get(id);\n        if (ncpDetails.qa_approved_by) {\n            const qaLeaderUser = db.prepare(\"SELECT id FROM users WHERE username = ?\").get(ncpDetails.qa_approved_by);\n            if (qaLeaderUser) {\n                createNotification(qaLeaderUser.id, ncp.ncp_id, \"NCP Workflow Completed\", `NCP ${ncp.ncp_id} has been fully approved by QA Manager and archived.`);\n            }\n        }\n    }\n    return result;\n}\nfunction rejectNCPByQAManager(id, rejectionReason, qaManagerUsername) {\n    const stmt = db.prepare(`\n    UPDATE ncp_reports \n    SET status = 'qa_approved',\n        manager_approved_by = ?,\n        manager_approved_at = CURRENT_TIMESTAMP,\n        manager_rejection_reason = ?\n    WHERE id = ?\n  `);\n    const result = stmt.run(qaManagerUsername, rejectionReason, id);\n    if (result.changes > 0) {\n        // Get NCP details for notification\n        const ncp = db.prepare(\"SELECT ncp_id, assigned_team_leader FROM ncp_reports WHERE id = ?\").get(id);\n        // Create notification for assigned team leader\n        const teamLeaderUser = db.prepare(\"SELECT id FROM users WHERE username = ?\").get(ncp.assigned_team_leader);\n        if (teamLeaderUser) {\n            createNotification(teamLeaderUser.id, ncp.ncp_id, \"NCP Rejected by QA Manager\", `NCP ${ncp.ncp_id} has been rejected by QA Manager and returned for reprocessing. Reason: ${rejectionReason}`);\n        }\n    }\n    return result;\n}\n// FIXED: Notification functions\nfunction createNotification(userId, ncpId, title, message, type = \"info\") {\n    const stmt = db.prepare(`\n    INSERT INTO notifications (user_id, ncp_id, title, message, type)\n    VALUES (?, ?, ?, ?, ?)\n  `);\n    const result = stmt.run(userId, ncpId, title, message, type);\n    return result;\n}\nfunction createNotificationForRole(role, ncpId, title, message, type = \"info\") {\n    const users = db.prepare(\"SELECT id FROM users WHERE role = ?\").all(role);\n    for (const user of users){\n        createNotification(user.id, ncpId, title, message, type);\n    }\n}\nfunction getNotificationsForUser(userId, limit = 10) {\n    return db.prepare(`\n    SELECT * FROM notifications \n    WHERE user_id = ? \n    ORDER BY created_at DESC \n    LIMIT ?\n  `).all(userId, limit);\n}\nfunction getUnreadNotificationCount(userId) {\n    const result = db.prepare(\"SELECT COUNT(*) as count FROM notifications WHERE user_id = ? AND is_read = FALSE\").get(userId);\n    return result.count;\n}\nfunction markNotificationAsRead(notificationId) {\n    return db.prepare(\"UPDATE notifications SET is_read = TRUE WHERE id = ?\").run(notificationId);\n}\nfunction markAllNotificationsAsRead(userId) {\n    return db.prepare(\"UPDATE notifications SET is_read = TRUE WHERE user_id = ?\").run(userId);\n}\n// Statistics functions\nfunction getNCPStatistics() {\n    const total = db.prepare(\"SELECT COUNT(*) as count FROM ncp_reports\").get();\n    const pending = db.prepare('SELECT COUNT(*) as count FROM ncp_reports WHERE status = \"pending\"').get();\n    const qaApproved = db.prepare('SELECT COUNT(*) as count FROM ncp_reports WHERE status = \"qa_approved\"').get();\n    const tlProcessed = db.prepare('SELECT COUNT(*) as count FROM ncp_reports WHERE status = \"tl_processed\"').get();\n    const rejected = db.prepare('SELECT COUNT(*) as count FROM ncp_reports WHERE status LIKE \"%rejected\"').get();\n    return {\n        total: total.count,\n        pending: pending.count,\n        qaApproved: qaApproved.count,\n        tlProcessed: tlProcessed.count,\n        rejected: rejected.count\n    };\n}\nfunction getNCPStatisticsForRole(userRole, username) {\n    let baseQuery = \"\";\n    let params = [];\n    switch(userRole){\n        case \"user\":\n            baseQuery = \"FROM ncp_reports WHERE submitted_by = ?\";\n            params = [\n                username\n            ];\n            break;\n        case \"qa_leader\":\n            baseQuery = \"FROM ncp_reports\";\n            break;\n        case \"team_leader\":\n            baseQuery = \"FROM ncp_reports WHERE assigned_team_leader = ?\";\n            params = [\n                username\n            ];\n            break;\n        default:\n            baseQuery = \"FROM ncp_reports\";\n    }\n    const total = db.prepare(`SELECT COUNT(*) as count ${baseQuery}`).get(...params);\n    const pending = db.prepare(`SELECT COUNT(*) as count ${baseQuery} AND status = 'pending'`).get(...params);\n    const approved = db.prepare(`SELECT COUNT(*) as count ${baseQuery} AND status LIKE '%approved'`).get(...params);\n    const processed = db.prepare(`SELECT COUNT(*) as count ${baseQuery} AND status LIKE '%processed'`).get(...params);\n    return {\n        total: total.count,\n        pending: pending.count,\n        approved: approved.count,\n        processed: processed.count\n    };\n}\n// Update existing records to have default values for new columns\nfunction updateExistingRecords() {\n    const updateQuery = `\n    UPDATE ncp_reports SET \n      jumlah_sortir = COALESCE(jumlah_sortir, '0'),\n      jumlah_release = COALESCE(jumlah_release, '0'), \n      jumlah_reject = COALESCE(jumlah_reject, '0')\n    WHERE jumlah_sortir IS NULL OR jumlah_release IS NULL OR jumlah_reject IS NULL\n  `;\n    const result = db.prepare(updateQuery).run();\n    return result;\n}\n// Initialize database on import\ninitializeDatabase();\nupdateExistingRecords();\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RyxNQUFNeUQsV0FBV2pILEdBQUdHLE9BQU8sQ0FBQyxDQUFDLHlCQUF5QixFQUFFNkcsVUFBVSw0QkFBNEIsQ0FBQyxFQUFFNUcsR0FBRyxJQUFJb0Q7SUFDeEcsTUFBTTBELFlBQVlsSCxHQUFHRyxPQUFPLENBQUMsQ0FBQyx5QkFBeUIsRUFBRTZHLFVBQVUsNkJBQTZCLENBQUMsRUFBRTVHLEdBQUcsSUFBSW9EO0lBRTFHLE9BQU87UUFDTGtELE9BQU9BLE1BQU1MLEtBQUs7UUFDbEJNLFNBQVNBLFFBQVFOLEtBQUs7UUFDdEJZLFVBQVVBLFNBQVNaLEtBQUs7UUFDeEJhLFdBQVdBLFVBQVViLEtBQUs7SUFDNUI7QUFDRjtBQUVBLGlFQUFpRTtBQUMxRCxTQUFTYztJQUNkLE1BQU1DLGNBQWMsQ0FBQzs7Ozs7O0VBTXJCLENBQUM7SUFFRCxNQUFNOUUsU0FBU3RDLEdBQUdHLE9BQU8sQ0FBQ2lILGFBQWE3RSxHQUFHO0lBQzFDLE9BQU9EO0FBQ1Q7QUFFQSxnQ0FBZ0M7QUFDaENyQztBQUNBa0g7QUFFYSIsInNvdXJjZXMiOlsid2VicGFjazovL215LXYwLXByb2plY3QvLi9saWIvZGF0YWJhc2UudHM/NGQ0OSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgRGF0YWJhc2UgZnJvbSBcImJldHRlci1zcWxpdGUzXCJcbmltcG9ydCB7IGNvbXBhcmUgfSBmcm9tIFwiYmNyeXB0anNcIlxuXG4vLyBEYXRhYmFzZSBzY2hlbWEgYW5kIGNvbm5lY3Rpb25cbmNvbnN0IGRiID0gbmV3IERhdGFiYXNlKFwicWFfcG9ydGFsLmRiXCIpXG5cbi8vIEluaXRpYWxpemUgZGF0YWJhc2UgdGFibGVzIChjYWxsZWQgb25seSBpZiB0YWJsZXMgZG9uJ3QgZXhpc3QpXG5leHBvcnQgZnVuY3Rpb24gaW5pdGlhbGl6ZURhdGFiYXNlKCkge1xuICAvLyBDaGVjayBpZiB0YWJsZXMgZXhpc3RcbiAgY29uc3QgdGFibGVzRXhpc3QgPSBkYi5wcmVwYXJlKFwiU0VMRUNUIG5hbWUgRlJPTSBzcWxpdGVfbWFzdGVyIFdIRVJFIHR5cGU9J3RhYmxlJyBBTkQgbmFtZT0ndXNlcnMnXCIpLmdldCgpXG4gIGlmICh0YWJsZXNFeGlzdCkge1xuICAgIHJldHVyblxuICB9XG5cbiAgLy8gVXNlcnMgdGFibGVcbiAgZGIuZXhlYyhgXG4gICAgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgdXNlcnMgKFxuICAgICAgaWQgSU5URUdFUiBQUklNQVJZIEtFWSBBVVRPSU5DUkVNRU5ULFxuICAgICAgdXNlcm5hbWUgVEVYVCBVTklRVUUgTk9UIE5VTEwsXG4gICAgICBwYXNzd29yZCBURVhUIE5PVCBOVUxMLFxuICAgICAgcm9sZSBURVhUIERFRkFVTFQgJ3VzZXInLFxuICAgICAgZnVsbF9uYW1lIFRFWFQsXG4gICAgICBjcmVhdGVkX2F0IERBVEVUSU1FIERFRkFVTFQgQ1VSUkVOVF9USU1FU1RBTVBcbiAgICApXG4gIGApXG5cbiAgLy8gTkNQIFJlcG9ydHMgdGFibGUgd2l0aCBleHRlbmRlZCBmaWVsZHMgZm9yIGFwcHJvdmFsIHdvcmtmbG93XG4gIGRiLmV4ZWMoYFxuICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIG5jcF9yZXBvcnRzIChcbiAgICAgIGlkIElOVEVHRVIgUFJJTUFSWSBLRVkgQVVUT0lOQ1JFTUVOVCxcbiAgICAgIG5jcF9pZCBURVhUIFVOSVFVRSBOT1QgTlVMTCxcbiAgICAgIHNrdV9jb2RlIFRFWFQgTk9UIE5VTEwsXG4gICAgICBtYWNoaW5lX2NvZGUgVEVYVCBOT1QgTlVMTCxcbiAgICAgIGRhdGUgVEVYVCBOT1QgTlVMTCxcbiAgICAgIHRpbWVfaW5jaWRlbnQgVEVYVCBOT1QgTlVMTCxcbiAgICAgIGhvbGRfcXVhbnRpdHkgSU5URUdFUiBOT1QgTlVMTCxcbiAgICAgIGhvbGRfcXVhbnRpdHlfdW9tIFRFWFQgTk9UIE5VTEwsXG4gICAgICBwcm9ibGVtX2Rlc2NyaXB0aW9uIFRFWFQgTk9UIE5VTEwsXG4gICAgICBwaG90b19hdHRhY2htZW50IFRFWFQsXG4gICAgICBxYV9sZWFkZXIgVEVYVCBOT1QgTlVMTCxcbiAgICAgIHN0YXR1cyBURVhUIERFRkFVTFQgJ3BlbmRpbmcnLFxuICAgICAgc3VibWl0dGVkX2J5IFRFWFQgTk9UIE5VTEwsXG4gICAgICBzdWJtaXR0ZWRfYXQgREFURVRJTUUgREVGQVVMVCBDVVJSRU5UX1RJTUVTVEFNUCxcbiAgICAgIFxuICAgICAgLS0gUUEgTGVhZGVyIEFwcHJvdmFsIEZpZWxkc1xuICAgICAgcWFfYXBwcm92ZWRfYnkgVEVYVCxcbiAgICAgIHFhX2FwcHJvdmVkX2F0IERBVEVUSU1FLFxuICAgICAgZGlzcG9zaXNpIFRFWFQsXG4gICAgICBqdW1sYWhfc29ydGlyIFRFWFQgREVGQVVMVCAnMCcsXG4gICAgICBqdW1sYWhfcmVsZWFzZSBURVhUIERFRkFVTFQgJzAnLFxuICAgICAganVtbGFoX3JlamVjdCBURVhUIERFRkFVTFQgJzAnLFxuICAgICAgYXNzaWduZWRfdGVhbV9sZWFkZXIgVEVYVCxcbiAgICAgIHFhX3JlamVjdGlvbl9yZWFzb24gVEVYVCxcbiAgICAgIFxuICAgICAgLS0gVGVhbSBMZWFkZXIgRmllbGRzXG4gICAgICB0bF9wcm9jZXNzZWRfYnkgVEVYVCxcbiAgICAgIHRsX3Byb2Nlc3NlZF9hdCBEQVRFVElNRSxcbiAgICAgIHJvb3RfY2F1c2VfYW5hbHlzaXMgVEVYVCxcbiAgICAgIGNvcnJlY3RpdmVfYWN0aW9uIFRFWFQsXG4gICAgICBwcmV2ZW50aXZlX2FjdGlvbiBURVhULFxuICAgICAgXG4gICAgICAtLSBQcm9jZXNzIExlYWQgRmllbGRzXG4gICAgICBwcm9jZXNzX2FwcHJvdmVkX2J5IFRFWFQsXG4gICAgICBwcm9jZXNzX2FwcHJvdmVkX2F0IERBVEVUSU1FLFxuICAgICAgcHJvY2Vzc19yZWplY3Rpb25fcmVhc29uIFRFWFQsXG4gICAgICBwcm9jZXNzX2NvbW1lbnQgVEVYVCxcbiAgICAgIFxuICAgICAgLS0gUUEgTWFuYWdlciBGaWVsZHNcbiAgICAgIG1hbmFnZXJfYXBwcm92ZWRfYnkgVEVYVCxcbiAgICAgIG1hbmFnZXJfYXBwcm92ZWRfYXQgREFURVRJTUUsXG4gICAgICBtYW5hZ2VyX3JlamVjdGlvbl9yZWFzb24gVEVYVCxcbiAgICAgIG1hbmFnZXJfY29tbWVudCBURVhULFxuICAgICAgXG4gICAgICAtLSBGaW5hbCBzdGF0dXNcbiAgICAgIGFyY2hpdmVkX2F0IERBVEVUSU1FXG4gICAgKVxuICBgKVxuXG4gIC8vIE5vdGlmaWNhdGlvbnMgdGFibGVcbiAgZGIuZXhlYyhgXG4gICAgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgbm90aWZpY2F0aW9ucyAoXG4gICAgICBpZCBJTlRFR0VSIFBSSU1BUlkgS0VZIEFVVE9JTkNSRU1FTlQsXG4gICAgICB1c2VyX2lkIElOVEVHRVIgTk9UIE5VTEwsXG4gICAgICBuY3BfaWQgVEVYVCBOT1QgTlVMTCxcbiAgICAgIHRpdGxlIFRFWFQgTk9UIE5VTEwsXG4gICAgICBtZXNzYWdlIFRFWFQgTk9UIE5VTEwsXG4gICAgICB0eXBlIFRFWFQgREVGQVVMVCAnaW5mbycsXG4gICAgICBpc19yZWFkIEJPT0xFQU4gREVGQVVMVCBGQUxTRSxcbiAgICAgIGNyZWF0ZWRfYXQgREFURVRJTUUgREVGQVVMVCBDVVJSRU5UX1RJTUVTVEFNUCxcbiAgICAgIEZPUkVJR04gS0VZICh1c2VyX2lkKSBSRUZFUkVOQ0VTIHVzZXJzIChpZClcbiAgICApXG4gIGApXG59XG5cbi8vIEZJWEVEOiBHZW5lcmF0ZSBhdXRvbWF0aWMgTkNQIG51bWJlciB3aXRoIGZvcm1hdCBZWU1NLVhYWFhcbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZU5DUE51bWJlcigpOiBzdHJpbmcge1xuICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpXG4gIGNvbnN0IHllYXIgPSBub3cuZ2V0RnVsbFllYXIoKS50b1N0cmluZygpLnNsaWNlKC0yKVxuICBjb25zdCBtb250aCA9IChub3cuZ2V0TW9udGgoKSArIDEpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgXCIwXCIpXG5cbiAgLy8gR2V0IHRoZSBsYXRlc3Qgc2VyaWFsIG51bWJlciBmb3IgY3VycmVudCB5ZWFyXG4gIGNvbnN0IGxhdGVzdFJlY29yZCA9IGRiXG4gICAgLnByZXBhcmUoYFxuICAgIFNFTEVDVCBuY3BfaWQgRlJPTSBuY3BfcmVwb3J0cyBcbiAgICBXSEVSRSBuY3BfaWQgTElLRSA/IFxuICAgIE9SREVSIEJZIG5jcF9pZCBERVNDIFxuICAgIExJTUlUIDFcbiAgYClcbiAgICAuZ2V0KGAke3llYXJ9JHttb250aH0tJWApXG5cbiAgbGV0IHNlcmlhbE51bWJlciA9IDFcblxuICBpZiAobGF0ZXN0UmVjb3JkKSB7XG4gICAgY29uc3QgZXhpc3RpbmdTZXJpYWwgPSBsYXRlc3RSZWNvcmQubmNwX2lkLnNwbGl0KFwiLVwiKVsxXVxuICAgIHNlcmlhbE51bWJlciA9IE51bWJlci5wYXJzZUludChleGlzdGluZ1NlcmlhbCkgKyAxXG4gIH1cblxuICBjb25zdCBmb3JtYXR0ZWRTZXJpYWwgPSBzZXJpYWxOdW1iZXIudG9TdHJpbmcoKS5wYWRTdGFydCg0LCBcIjBcIilcbiAgcmV0dXJuIGAke3llYXJ9JHttb250aH0tJHtmb3JtYXR0ZWRTZXJpYWx9YFxufVxuXG4vLyBGSVhFRDogVXNlciBhdXRoZW50aWNhdGlvbiBmdW5jdGlvbnNcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhdXRoZW50aWNhdGVVc2VyKHVzZXJuYW1lOiBzdHJpbmcsIHBhc3N3b3JkOiBzdHJpbmcpIHtcbiAgY29uc3QgdXNlciA9IGRiLnByZXBhcmUoXCJTRUxFQ1QgKiBGUk9NIHVzZXJzIFdIRVJFIHVzZXJuYW1lID0gP1wiKS5nZXQodXNlcm5hbWUpXG4gIGlmICghdXNlcikgcmV0dXJuIG51bGxcblxuICBjb25zdCBpc1ZhbGlkID0gYXdhaXQgY29tcGFyZShwYXNzd29yZCwgdXNlci5wYXNzd29yZClcbiAgaWYgKCFpc1ZhbGlkKSByZXR1cm4gbnVsbFxuXG4gIHJldHVybiB7XG4gICAgaWQ6IHVzZXIuaWQsXG4gICAgdXNlcm5hbWU6IHVzZXIudXNlcm5hbWUsXG4gICAgcm9sZTogdXNlci5yb2xlLFxuICAgIGZ1bGxOYW1lOiB1c2VyLmZ1bGxfbmFtZSxcbiAgfVxufVxuXG4vLyBHZXQgdXNlciBieSB1c2VybmFtZVxuZXhwb3J0IGZ1bmN0aW9uIGdldFVzZXJCeVVzZXJuYW1lKHVzZXJuYW1lOiBzdHJpbmcpIHtcbiAgcmV0dXJuIGRiLnByZXBhcmUoXCJTRUxFQ1QgaWQsIHVzZXJuYW1lLCByb2xlLCBmdWxsX25hbWUgRlJPTSB1c2VycyBXSEVSRSB1c2VybmFtZSA9ID9cIikuZ2V0KHVzZXJuYW1lKVxufVxuXG4vLyBGSVhFRDogTkNQIFJlcG9ydCBmdW5jdGlvbnNcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVOQ1BSZXBvcnQoZGF0YTogYW55KSB7XG4gIGNvbnN0IG5jcElkID0gZ2VuZXJhdGVOQ1BOdW1iZXIoKVxuXG4gIGNvbnN0IHN0bXQgPSBkYi5wcmVwYXJlKGBcbiAgICBJTlNFUlQgSU5UTyBuY3BfcmVwb3J0cyAoXG4gICAgICBuY3BfaWQsIHNrdV9jb2RlLCBtYWNoaW5lX2NvZGUsIGRhdGUsIHRpbWVfaW5jaWRlbnQsXG4gICAgICBob2xkX3F1YW50aXR5LCBob2xkX3F1YW50aXR5X3VvbSwgcHJvYmxlbV9kZXNjcmlwdGlvbixcbiAgICAgIHBob3RvX2F0dGFjaG1lbnQsIHFhX2xlYWRlciwgc3VibWl0dGVkX2J5XG4gICAgKSBWQUxVRVMgKD8sID8sID8sID8sID8sID8sID8sID8sID8sID8sID8pXG4gIGApXG5cbiAgY29uc3QgcmVzdWx0ID0gc3RtdC5ydW4oXG4gICAgbmNwSWQsXG4gICAgZGF0YS5za3VDb2RlLFxuICAgIGRhdGEubWFjaGluZUNvZGUsXG4gICAgZGF0YS5kYXRlLFxuICAgIGRhdGEudGltZUluY2lkZW50LFxuICAgIGRhdGEuaG9sZFF1YW50aXR5LFxuICAgIGRhdGEuaG9sZFF1YW50aXR5VU9NLFxuICAgIGRhdGEucHJvYmxlbURlc2NyaXB0aW9uLFxuICAgIGRhdGEucGhvdG9BdHRhY2htZW50LFxuICAgIGRhdGEucWFMZWFkZXIsXG4gICAgZGF0YS5zdWJtaXR0ZWRCeSxcbiAgKVxuXG4gIC8vIENyZWF0ZSBub3RpZmljYXRpb24gZm9yIFFBIExlYWRlcnNcbiAgY3JlYXRlTm90aWZpY2F0aW9uRm9yUm9sZShcInFhX2xlYWRlclwiLCBuY3BJZCwgXCJOZXcgTkNQIFN1Ym1pdHRlZFwiLCBgTkNQICR7bmNwSWR9IHJlcXVpcmVzIHlvdXIgYXBwcm92YWxgKVxuXG4gIHJldHVybiB7IGlkOiByZXN1bHQubGFzdEluc2VydFJvd2lkLCBuY3BJZCB9XG59XG5cbi8vIEdldCBOQ1BzIGJhc2VkIG9uIHVzZXIgcm9sZSBhbmQgcGVybWlzc2lvbnNcbmV4cG9ydCBmdW5jdGlvbiBnZXROQ1BSZXBvcnRzRm9yVXNlcih1c2VySWQ6IG51bWJlciwgdXNlclJvbGU6IHN0cmluZywgdXNlcm5hbWU6IHN0cmluZykge1xuICBsZXQgcXVlcnkgPSBcIlNFTEVDVCAqIEZST00gbmNwX3JlcG9ydHNcIlxuICBsZXQgcGFyYW1zOiBhbnlbXSA9IFtdXG5cbiAgc3dpdGNoICh1c2VyUm9sZSkge1xuICAgIGNhc2UgXCJ1c2VyXCI6XG4gICAgICBxdWVyeSArPSBcIiBXSEVSRSBzdWJtaXR0ZWRfYnkgPSA/IE9SREVSIEJZIHN1Ym1pdHRlZF9hdCBERVNDXCJcbiAgICAgIHBhcmFtcyA9IFt1c2VybmFtZV1cbiAgICAgIGJyZWFrXG4gICAgY2FzZSBcInFhX2xlYWRlclwiOlxuICAgICAgcXVlcnkgKz0gXCIgT1JERVIgQlkgc3VibWl0dGVkX2F0IERFU0NcIlxuICAgICAgYnJlYWtcbiAgICBjYXNlIFwidGVhbV9sZWFkZXJcIjpcbiAgICAgIHF1ZXJ5ICs9IFwiIFdIRVJFIGFzc2lnbmVkX3RlYW1fbGVhZGVyID0gPyBPUkRFUiBCWSBzdWJtaXR0ZWRfYXQgREVTQ1wiXG4gICAgICBwYXJhbXMgPSBbdXNlcm5hbWVdXG4gICAgICBicmVha1xuICAgIGNhc2UgXCJwcm9jZXNzX2xlYWRcIjpcbiAgICAgIHF1ZXJ5ICs9IFwiIFdIRVJFIHN0YXR1cyBJTiAoJ3RsX3Byb2Nlc3NlZCcsICdwcm9jZXNzX2FwcHJvdmVkJywgJ3Byb2Nlc3NfcmVqZWN0ZWQnKSBPUkRFUiBCWSBzdWJtaXR0ZWRfYXQgREVTQ1wiXG4gICAgICBicmVha1xuICAgIGNhc2UgXCJxYV9tYW5hZ2VyXCI6XG4gICAgY2FzZSBcImFkbWluXCI6XG4gICAgICBxdWVyeSArPSBcIiBPUkRFUiBCWSBzdWJtaXR0ZWRfYXQgREVTQ1wiXG4gICAgICBicmVha1xuICAgIGRlZmF1bHQ6XG4gICAgICBxdWVyeSArPSBcIiBXSEVSRSBzdWJtaXR0ZWRfYnkgPSA/IE9SREVSIEJZIHN1Ym1pdHRlZF9hdCBERVNDXCJcbiAgICAgIHBhcmFtcyA9IFt1c2VybmFtZV1cbiAgfVxuXG4gIGNvbnN0IHJlc3VsdHMgPSBkYi5wcmVwYXJlKHF1ZXJ5KS5hbGwoLi4ucGFyYW1zKVxuICByZXR1cm4gcmVzdWx0c1xufVxuXG4vLyBGSVhFRDogR2V0IHBlbmRpbmcgTkNQcyBmb3IgYXBwcm92YWwgYmFzZWQgb24gcm9sZVxuZXhwb3J0IGZ1bmN0aW9uIGdldFBlbmRpbmdOQ1BzRm9yUm9sZSh1c2VyUm9sZTogc3RyaW5nLCB1c2VybmFtZTogc3RyaW5nKSB7XG4gIGxldCBxdWVyeSA9IFwiXCJcbiAgbGV0IHBhcmFtczogYW55W10gPSBbXVxuXG4gIHN3aXRjaCAodXNlclJvbGUpIHtcbiAgICBjYXNlIFwicWFfbGVhZGVyXCI6XG4gICAgICBxdWVyeSA9IFwiU0VMRUNUICogRlJPTSBuY3BfcmVwb3J0cyBXSEVSRSBzdGF0dXMgPSAncGVuZGluZycgT1JERVIgQlkgc3VibWl0dGVkX2F0IEFTQ1wiXG4gICAgICBicmVha1xuICAgIGNhc2UgXCJ0ZWFtX2xlYWRlclwiOlxuICAgICAgLy8gRklYRUQ6IFNob3cgTkNQcyBhc3NpZ25lZCB0byB0aGlzIHRlYW0gbGVhZGVyXG4gICAgICBxdWVyeSA9IGBcbiAgICAgICAgU0VMRUNUICogRlJPTSBuY3BfcmVwb3J0cyBcbiAgICAgICAgV0hFUkUgYXNzaWduZWRfdGVhbV9sZWFkZXIgPSA/IFxuICAgICAgICBBTkQgc3RhdHVzIElOICgncWFfYXBwcm92ZWQnLCAndGxfcHJvY2Vzc2VkJykgXG4gICAgICAgIE9SREVSIEJZIHFhX2FwcHJvdmVkX2F0IEFTQ1xuICAgICAgYFxuICAgICAgcGFyYW1zID0gW3VzZXJuYW1lXVxuICAgICAgYnJlYWtcbiAgICBjYXNlIFwicHJvY2Vzc19sZWFkXCI6XG4gICAgICBxdWVyeSA9IFwiU0VMRUNUICogRlJPTSBuY3BfcmVwb3J0cyBXSEVSRSBzdGF0dXMgPSAndGxfcHJvY2Vzc2VkJyBPUkRFUiBCWSB0bF9wcm9jZXNzZWRfYXQgQVNDXCJcbiAgICAgIGJyZWFrXG4gICAgY2FzZSBcInFhX21hbmFnZXJcIjpcbiAgICAgIHF1ZXJ5ID0gXCJTRUxFQ1QgKiBGUk9NIG5jcF9yZXBvcnRzIFdIRVJFIHN0YXR1cyA9ICdwcm9jZXNzX2FwcHJvdmVkJyBPUkRFUiBCWSBwcm9jZXNzX2FwcHJvdmVkX2F0IEFTQ1wiXG4gICAgICBicmVha1xuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gW11cbiAgfVxuXG4gIGNvbnN0IHJlc3VsdHMgPSBkYi5wcmVwYXJlKHF1ZXJ5KS5hbGwoLi4ucGFyYW1zKVxuICByZXR1cm4gcmVzdWx0c1xufVxuXG4vLyBHZXQgc2luZ2xlIE5DUCBieSBJRFxuZXhwb3J0IGZ1bmN0aW9uIGdldE5DUEJ5SWQoaWQ6IG51bWJlcikge1xuICBjb25zdCByZXN1bHQgPSBkYi5wcmVwYXJlKFwiU0VMRUNUICogRlJPTSBuY3BfcmVwb3J0cyBXSEVSRSBpZCA9ID9cIikuZ2V0KGlkKVxuICByZXR1cm4gcmVzdWx0XG59XG5cbi8vIEZJWEVEOiBRQSBMZWFkZXIgYXBwcm92YWwgLSBQcm9wZXIgZGF0YSBmbG93IHRvIFRlYW0gTGVhZGVyXG5leHBvcnQgZnVuY3Rpb24gYXBwcm92ZU5DUEJ5UUFMZWFkZXIoaWQ6IG51bWJlciwgYXBwcm92YWxEYXRhOiBhbnksIHFhTGVhZGVyVXNlcm5hbWU6IHN0cmluZykge1xuICBjb25zdCBzdG10ID0gZGIucHJlcGFyZShgXG4gICAgVVBEQVRFIG5jcF9yZXBvcnRzIFxuICAgIFNFVCBzdGF0dXMgPSAncWFfYXBwcm92ZWQnLFxuICAgICAgICBxYV9hcHByb3ZlZF9ieSA9ID8sXG4gICAgICAgIHFhX2FwcHJvdmVkX2F0ID0gQ1VSUkVOVF9USU1FU1RBTVAsXG4gICAgICAgIGRpc3Bvc2lzaSA9ID8sXG4gICAgICAgIGp1bWxhaF9zb3J0aXIgPSA/LFxuICAgICAgICBqdW1sYWhfcmVsZWFzZSA9ID8sXG4gICAgICAgIGp1bWxhaF9yZWplY3QgPSA/LFxuICAgICAgICBhc3NpZ25lZF90ZWFtX2xlYWRlciA9ID9cbiAgICBXSEVSRSBpZCA9ID9cbiAgYClcblxuICBjb25zdCByZXN1bHQgPSBzdG10LnJ1bihcbiAgICBxYUxlYWRlclVzZXJuYW1lLFxuICAgIGFwcHJvdmFsRGF0YS5kaXNwb3Npc2ksXG4gICAgYXBwcm92YWxEYXRhLmp1bWxhaFNvcnRpciB8fCBcIjBcIixcbiAgICBhcHByb3ZhbERhdGEuanVtbGFoUmVsZWFzZSB8fCBcIjBcIixcbiAgICBhcHByb3ZhbERhdGEuanVtbGFoUmVqZWN0IHx8IFwiMFwiLFxuICAgIGFwcHJvdmFsRGF0YS5hc3NpZ25lZFRlYW1MZWFkZXIsXG4gICAgaWQsXG4gIClcblxuICBpZiAocmVzdWx0LmNoYW5nZXMgPiAwKSB7XG4gICAgLy8gR2V0IE5DUCBkZXRhaWxzIGZvciBub3RpZmljYXRpb25cbiAgICBjb25zdCBuY3AgPSBkYi5wcmVwYXJlKFwiU0VMRUNUIG5jcF9pZCBGUk9NIG5jcF9yZXBvcnRzIFdIRVJFIGlkID0gP1wiKS5nZXQoaWQpXG5cbiAgICAvLyBGSVhFRDogQ3JlYXRlIG5vdGlmaWNhdGlvbiBmb3IgYXNzaWduZWQgdGVhbSBsZWFkZXIgdXNpbmcgdGhlIGV4YWN0IHVzZXJuYW1lXG4gICAgY29uc3QgdGVhbUxlYWRlclVzZXIgPSBkYi5wcmVwYXJlKFwiU0VMRUNUIGlkIEZST00gdXNlcnMgV0hFUkUgdXNlcm5hbWUgPSA/XCIpLmdldChhcHByb3ZhbERhdGEuYXNzaWduZWRUZWFtTGVhZGVyKVxuICAgIGlmICh0ZWFtTGVhZGVyVXNlcikge1xuICAgICAgY3JlYXRlTm90aWZpY2F0aW9uKFxuICAgICAgICB0ZWFtTGVhZGVyVXNlci5pZCxcbiAgICAgICAgbmNwLm5jcF9pZCxcbiAgICAgICAgXCJOQ1AgQXNzaWduZWQgdG8gWW91XCIsXG4gICAgICAgIGBOQ1AgJHtuY3AubmNwX2lkfSBoYXMgYmVlbiBhcHByb3ZlZCBieSBRQSBMZWFkZXIgYW5kIGFzc2lnbmVkIHRvIHlvdSBmb3IgUkNBIGFuYWx5c2lzYCxcbiAgICAgIClcbiAgICB9XG5cbiAgICAvLyBBbHNvIGNyZWF0ZSBub3RpZmljYXRpb24gZm9yIGFsbCB0ZWFtIGxlYWRlcnMgYXMgYmFja3VwXG4gICAgY3JlYXRlTm90aWZpY2F0aW9uRm9yUm9sZShcbiAgICAgIFwidGVhbV9sZWFkZXJcIixcbiAgICAgIG5jcC5uY3BfaWQsXG4gICAgICBcIk5ldyBOQ1AgQXNzaWdubWVudFwiLFxuICAgICAgYE5DUCAke25jcC5uY3BfaWR9IGhhcyBiZWVuIGFwcHJvdmVkIGFuZCBhc3NpZ25lZCB0byAke2FwcHJvdmFsRGF0YS5hc3NpZ25lZFRlYW1MZWFkZXJ9YCxcbiAgICApXG4gIH1cblxuICByZXR1cm4gcmVzdWx0XG59XG5cbi8vIFFBIExlYWRlciByZWplY3Rpb25cbmV4cG9ydCBmdW5jdGlvbiByZWplY3ROQ1BCeVFBTGVhZGVyKGlkOiBudW1iZXIsIHJlamVjdGlvblJlYXNvbjogc3RyaW5nLCBxYUxlYWRlclVzZXJuYW1lOiBzdHJpbmcpIHtcbiAgY29uc3Qgc3RtdCA9IGRiLnByZXBhcmUoYFxuICAgIFVQREFURSBuY3BfcmVwb3J0cyBcbiAgICBTRVQgc3RhdHVzID0gJ3FhX3JlamVjdGVkJyxcbiAgICAgICAgcWFfYXBwcm92ZWRfYnkgPSA/LFxuICAgICAgICBxYV9hcHByb3ZlZF9hdCA9IENVUlJFTlRfVElNRVNUQU1QLFxuICAgICAgICBxYV9yZWplY3Rpb25fcmVhc29uID0gP1xuICAgIFdIRVJFIGlkID0gP1xuICBgKVxuXG4gIGNvbnN0IHJlc3VsdCA9IHN0bXQucnVuKHFhTGVhZGVyVXNlcm5hbWUsIHJlamVjdGlvblJlYXNvbiwgaWQpXG4gIHJldHVybiByZXN1bHRcbn1cblxuLy8gVGVhbSBMZWFkZXIgcHJvY2Vzc2luZ1xuZXhwb3J0IGZ1bmN0aW9uIHByb2Nlc3NOQ1BCeVRlYW1MZWFkZXIoaWQ6IG51bWJlciwgcHJvY2Vzc0RhdGE6IGFueSwgdGVhbUxlYWRlclVzZXJuYW1lOiBzdHJpbmcpIHtcbiAgY29uc3Qgc3RtdCA9IGRiLnByZXBhcmUoYFxuICAgIFVQREFURSBuY3BfcmVwb3J0cyBcbiAgICBTRVQgc3RhdHVzID0gJ3RsX3Byb2Nlc3NlZCcsXG4gICAgICAgIHRsX3Byb2Nlc3NlZF9ieSA9ID8sXG4gICAgICAgIHRsX3Byb2Nlc3NlZF9hdCA9IENVUlJFTlRfVElNRVNUQU1QLFxuICAgICAgICByb290X2NhdXNlX2FuYWx5c2lzID0gPyxcbiAgICAgICAgY29ycmVjdGl2ZV9hY3Rpb24gPSA/LFxuICAgICAgICBwcmV2ZW50aXZlX2FjdGlvbiA9ID9cbiAgICBXSEVSRSBpZCA9ID9cbiAgYClcblxuICBjb25zdCByZXN1bHQgPSBzdG10LnJ1bihcbiAgICB0ZWFtTGVhZGVyVXNlcm5hbWUsXG4gICAgcHJvY2Vzc0RhdGEucm9vdENhdXNlQW5hbHlzaXMsXG4gICAgcHJvY2Vzc0RhdGEuY29ycmVjdGl2ZUFjdGlvbixcbiAgICBwcm9jZXNzRGF0YS5wcmV2ZW50aXZlQWN0aW9uLFxuICAgIGlkLFxuICApXG5cbiAgaWYgKHJlc3VsdC5jaGFuZ2VzID4gMCkge1xuICAgIC8vIEdldCBOQ1AgZGV0YWlscyBmb3Igbm90aWZpY2F0aW9uXG4gICAgY29uc3QgbmNwID0gZGIucHJlcGFyZShcIlNFTEVDVCBuY3BfaWQgRlJPTSBuY3BfcmVwb3J0cyBXSEVSRSBpZCA9ID9cIikuZ2V0KGlkKVxuXG4gICAgLy8gQ3JlYXRlIG5vdGlmaWNhdGlvbiBmb3IgcHJvY2VzcyBsZWFkc1xuICAgIGNyZWF0ZU5vdGlmaWNhdGlvbkZvclJvbGUoXG4gICAgICBcInByb2Nlc3NfbGVhZFwiLFxuICAgICAgbmNwLm5jcF9pZCxcbiAgICAgIFwiTkNQIFJlYWR5IGZvciBQcm9jZXNzIFJldmlld1wiLFxuICAgICAgYE5DUCAke25jcC5uY3BfaWR9IGhhcyBiZWVuIHByb2Nlc3NlZCBieSBUZWFtIExlYWRlciBhbmQgcmVxdWlyZXMgcHJvY2VzcyByZXZpZXdgLFxuICAgIClcbiAgfVxuXG4gIHJldHVybiByZXN1bHRcbn1cblxuLy8gUHJvY2VzcyBMZWFkIGFwcHJvdmFsIGZ1bmN0aW9uc1xuZXhwb3J0IGZ1bmN0aW9uIGFwcHJvdmVOQ1BCeVByb2Nlc3NMZWFkKGlkOiBudW1iZXIsIGNvbW1lbnQ6IHN0cmluZywgcHJvY2Vzc0xlYWRVc2VybmFtZTogc3RyaW5nKSB7XG4gIGNvbnN0IHN0bXQgPSBkYi5wcmVwYXJlKGBcbiAgICBVUERBVEUgbmNwX3JlcG9ydHMgXG4gICAgU0VUIHN0YXR1cyA9ICdwcm9jZXNzX2FwcHJvdmVkJyxcbiAgICAgICAgcHJvY2Vzc19hcHByb3ZlZF9ieSA9ID8sXG4gICAgICAgIHByb2Nlc3NfYXBwcm92ZWRfYXQgPSBDVVJSRU5UX1RJTUVTVEFNUCxcbiAgICAgICAgcHJvY2Vzc19jb21tZW50ID0gP1xuICAgIFdIRVJFIGlkID0gP1xuICBgKVxuXG4gIGNvbnN0IHJlc3VsdCA9IHN0bXQucnVuKHByb2Nlc3NMZWFkVXNlcm5hbWUsIGNvbW1lbnQsIGlkKVxuXG4gIGlmIChyZXN1bHQuY2hhbmdlcyA+IDApIHtcbiAgICAvLyBHZXQgTkNQIGRldGFpbHMgZm9yIG5vdGlmaWNhdGlvblxuICAgIGNvbnN0IG5jcCA9IGRiLnByZXBhcmUoXCJTRUxFQ1QgbmNwX2lkIEZST00gbmNwX3JlcG9ydHMgV0hFUkUgaWQgPSA/XCIpLmdldChpZClcblxuICAgIC8vIENyZWF0ZSBub3RpZmljYXRpb24gZm9yIFFBIE1hbmFnZXJzXG4gICAgY3JlYXRlTm90aWZpY2F0aW9uRm9yUm9sZShcbiAgICAgIFwicWFfbWFuYWdlclwiLFxuICAgICAgbmNwLm5jcF9pZCxcbiAgICAgIFwiTkNQIFJlYWR5IGZvciBGaW5hbCBBcHByb3ZhbFwiLFxuICAgICAgYE5DUCAke25jcC5uY3BfaWR9IGhhcyBiZWVuIGFwcHJvdmVkIGJ5IFByb2Nlc3MgTGVhZCBhbmQgcmVxdWlyZXMgZmluYWwgUUEgTWFuYWdlciBhcHByb3ZhbGAsXG4gICAgKVxuICB9XG5cbiAgcmV0dXJuIHJlc3VsdFxufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVqZWN0TkNQQnlQcm9jZXNzTGVhZChpZDogbnVtYmVyLCByZWplY3Rpb25SZWFzb246IHN0cmluZywgcHJvY2Vzc0xlYWRVc2VybmFtZTogc3RyaW5nKSB7XG4gIGNvbnN0IHN0bXQgPSBkYi5wcmVwYXJlKGBcbiAgICBVUERBVEUgbmNwX3JlcG9ydHMgXG4gICAgU0VUIHN0YXR1cyA9ICdxYV9hcHByb3ZlZCcsXG4gICAgICAgIHByb2Nlc3NfYXBwcm92ZWRfYnkgPSA/LFxuICAgICAgICBwcm9jZXNzX2FwcHJvdmVkX2F0ID0gQ1VSUkVOVF9USU1FU1RBTVAsXG4gICAgICAgIHByb2Nlc3NfcmVqZWN0aW9uX3JlYXNvbiA9ID9cbiAgICBXSEVSRSBpZCA9ID9cbiAgYClcblxuICBjb25zdCByZXN1bHQgPSBzdG10LnJ1bihwcm9jZXNzTGVhZFVzZXJuYW1lLCByZWplY3Rpb25SZWFzb24sIGlkKVxuXG4gIGlmIChyZXN1bHQuY2hhbmdlcyA+IDApIHtcbiAgICAvLyBHZXQgTkNQIGRldGFpbHMgZm9yIG5vdGlmaWNhdGlvblxuICAgIGNvbnN0IG5jcCA9IGRiLnByZXBhcmUoXCJTRUxFQ1QgbmNwX2lkLCBhc3NpZ25lZF90ZWFtX2xlYWRlciBGUk9NIG5jcF9yZXBvcnRzIFdIRVJFIGlkID0gP1wiKS5nZXQoaWQpXG5cbiAgICAvLyBDcmVhdGUgbm90aWZpY2F0aW9uIGZvciBhc3NpZ25lZCB0ZWFtIGxlYWRlclxuICAgIGNvbnN0IHRlYW1MZWFkZXJVc2VyID0gZGIucHJlcGFyZShcIlNFTEVDVCBpZCBGUk9NIHVzZXJzIFdIRVJFIHVzZXJuYW1lID0gP1wiKS5nZXQobmNwLmFzc2lnbmVkX3RlYW1fbGVhZGVyKVxuICAgIGlmICh0ZWFtTGVhZGVyVXNlcikge1xuICAgICAgY3JlYXRlTm90aWZpY2F0aW9uKFxuICAgICAgICB0ZWFtTGVhZGVyVXNlci5pZCxcbiAgICAgICAgbmNwLm5jcF9pZCxcbiAgICAgICAgXCJOQ1AgUmVqZWN0ZWQgYnkgUHJvY2VzcyBMZWFkXCIsXG4gICAgICAgIGBOQ1AgJHtuY3AubmNwX2lkfSBoYXMgYmVlbiByZWplY3RlZCBieSBQcm9jZXNzIExlYWQgYW5kIHJldHVybmVkIGZvciByZXByb2Nlc3NpbmcuIFJlYXNvbjogJHtyZWplY3Rpb25SZWFzb259YCxcbiAgICAgIClcbiAgICB9XG4gIH1cblxuICByZXR1cm4gcmVzdWx0XG59XG5cbi8vIFFBIE1hbmFnZXIgYXBwcm92YWwgZnVuY3Rpb25zXG5leHBvcnQgZnVuY3Rpb24gYXBwcm92ZU5DUEJ5UUFNYW5hZ2VyKGlkOiBudW1iZXIsIGNvbW1lbnQ6IHN0cmluZywgcWFNYW5hZ2VyVXNlcm5hbWU6IHN0cmluZykge1xuICBjb25zdCBzdG10ID0gZGIucHJlcGFyZShgXG4gICAgVVBEQVRFIG5jcF9yZXBvcnRzIFxuICAgIFNFVCBzdGF0dXMgPSAnbWFuYWdlcl9hcHByb3ZlZCcsXG4gICAgICAgIG1hbmFnZXJfYXBwcm92ZWRfYnkgPSA/LFxuICAgICAgICBtYW5hZ2VyX2FwcHJvdmVkX2F0ID0gQ1VSUkVOVF9USU1FU1RBTVAsXG4gICAgICAgIG1hbmFnZXJfY29tbWVudCA9ID8sXG4gICAgICAgIGFyY2hpdmVkX2F0ID0gQ1VSUkVOVF9USU1FU1RBTVBcbiAgICBXSEVSRSBpZCA9ID9cbiAgYClcblxuICBjb25zdCByZXN1bHQgPSBzdG10LnJ1bihxYU1hbmFnZXJVc2VybmFtZSwgY29tbWVudCwgaWQpXG5cbiAgaWYgKHJlc3VsdC5jaGFuZ2VzID4gMCkge1xuICAgIC8vIEdldCBOQ1AgZGV0YWlscyBmb3Igbm90aWZpY2F0aW9uXG4gICAgY29uc3QgbmNwID0gZGIucHJlcGFyZShcIlNFTEVDVCBuY3BfaWQsIHN1Ym1pdHRlZF9ieSBGUk9NIG5jcF9yZXBvcnRzIFdIRVJFIGlkID0gP1wiKS5nZXQoaWQpXG5cbiAgICAvLyBDcmVhdGUgbm90aWZpY2F0aW9uIGZvciBvcmlnaW5hbCBzdWJtaXR0ZXJcbiAgICBjb25zdCBzdWJtaXR0ZXJVc2VyID0gZGIucHJlcGFyZShcIlNFTEVDVCBpZCBGUk9NIHVzZXJzIFdIRVJFIHVzZXJuYW1lID0gP1wiKS5nZXQobmNwLnN1Ym1pdHRlZF9ieSlcbiAgICBpZiAoc3VibWl0dGVyVXNlcikge1xuICAgICAgY3JlYXRlTm90aWZpY2F0aW9uKFxuICAgICAgICBzdWJtaXR0ZXJVc2VyLmlkLFxuICAgICAgICBuY3AubmNwX2lkLFxuICAgICAgICBcIk5DUCBXb3JrZmxvdyBDb21wbGV0ZWRcIixcbiAgICAgICAgYE5DUCAke25jcC5uY3BfaWR9IGhhcyBiZWVuIGZ1bGx5IGFwcHJvdmVkIGFuZCBhcmNoaXZlZC4gVGhlIHdvcmtmbG93IGlzIG5vdyBjb21wbGV0ZS5gLFxuICAgICAgKVxuICAgIH1cblxuICAgIC8vIEFsc28gbm90aWZ5IFFBIExlYWRlclxuICAgIGNvbnN0IG5jcERldGFpbHMgPSBkYi5wcmVwYXJlKFwiU0VMRUNUIHFhX2FwcHJvdmVkX2J5IEZST00gbmNwX3JlcG9ydHMgV0hFUkUgaWQgPSA/XCIpLmdldChpZClcbiAgICBpZiAobmNwRGV0YWlscy5xYV9hcHByb3ZlZF9ieSkge1xuICAgICAgY29uc3QgcWFMZWFkZXJVc2VyID0gZGIucHJlcGFyZShcIlNFTEVDVCBpZCBGUk9NIHVzZXJzIFdIRVJFIHVzZXJuYW1lID0gP1wiKS5nZXQobmNwRGV0YWlscy5xYV9hcHByb3ZlZF9ieSlcbiAgICAgIGlmIChxYUxlYWRlclVzZXIpIHtcbiAgICAgICAgY3JlYXRlTm90aWZpY2F0aW9uKFxuICAgICAgICAgIHFhTGVhZGVyVXNlci5pZCxcbiAgICAgICAgICBuY3AubmNwX2lkLFxuICAgICAgICAgIFwiTkNQIFdvcmtmbG93IENvbXBsZXRlZFwiLFxuICAgICAgICAgIGBOQ1AgJHtuY3AubmNwX2lkfSBoYXMgYmVlbiBmdWxseSBhcHByb3ZlZCBieSBRQSBNYW5hZ2VyIGFuZCBhcmNoaXZlZC5gLFxuICAgICAgICApXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHJlc3VsdFxufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVqZWN0TkNQQnlRQU1hbmFnZXIoaWQ6IG51bWJlciwgcmVqZWN0aW9uUmVhc29uOiBzdHJpbmcsIHFhTWFuYWdlclVzZXJuYW1lOiBzdHJpbmcpIHtcbiAgY29uc3Qgc3RtdCA9IGRiLnByZXBhcmUoYFxuICAgIFVQREFURSBuY3BfcmVwb3J0cyBcbiAgICBTRVQgc3RhdHVzID0gJ3FhX2FwcHJvdmVkJyxcbiAgICAgICAgbWFuYWdlcl9hcHByb3ZlZF9ieSA9ID8sXG4gICAgICAgIG1hbmFnZXJfYXBwcm92ZWRfYXQgPSBDVVJSRU5UX1RJTUVTVEFNUCxcbiAgICAgICAgbWFuYWdlcl9yZWplY3Rpb25fcmVhc29uID0gP1xuICAgIFdIRVJFIGlkID0gP1xuICBgKVxuXG4gIGNvbnN0IHJlc3VsdCA9IHN0bXQucnVuKHFhTWFuYWdlclVzZXJuYW1lLCByZWplY3Rpb25SZWFzb24sIGlkKVxuXG4gIGlmIChyZXN1bHQuY2hhbmdlcyA+IDApIHtcbiAgICAvLyBHZXQgTkNQIGRldGFpbHMgZm9yIG5vdGlmaWNhdGlvblxuICAgIGNvbnN0IG5jcCA9IGRiLnByZXBhcmUoXCJTRUxFQ1QgbmNwX2lkLCBhc3NpZ25lZF90ZWFtX2xlYWRlciBGUk9NIG5jcF9yZXBvcnRzIFdIRVJFIGlkID0gP1wiKS5nZXQoaWQpXG5cbiAgICAvLyBDcmVhdGUgbm90aWZpY2F0aW9uIGZvciBhc3NpZ25lZCB0ZWFtIGxlYWRlclxuICAgIGNvbnN0IHRlYW1MZWFkZXJVc2VyID0gZGIucHJlcGFyZShcIlNFTEVDVCBpZCBGUk9NIHVzZXJzIFdIRVJFIHVzZXJuYW1lID0gP1wiKS5nZXQobmNwLmFzc2lnbmVkX3RlYW1fbGVhZGVyKVxuICAgIGlmICh0ZWFtTGVhZGVyVXNlcikge1xuICAgICAgY3JlYXRlTm90aWZpY2F0aW9uKFxuICAgICAgICB0ZWFtTGVhZGVyVXNlci5pZCxcbiAgICAgICAgbmNwLm5jcF9pZCxcbiAgICAgICAgXCJOQ1AgUmVqZWN0ZWQgYnkgUUEgTWFuYWdlclwiLFxuICAgICAgICBgTkNQICR7bmNwLm5jcF9pZH0gaGFzIGJlZW4gcmVqZWN0ZWQgYnkgUUEgTWFuYWdlciBhbmQgcmV0dXJuZWQgZm9yIHJlcHJvY2Vzc2luZy4gUmVhc29uOiAke3JlamVjdGlvblJlYXNvbn1gLFxuICAgICAgKVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiByZXN1bHRcbn1cblxuLy8gRklYRUQ6IE5vdGlmaWNhdGlvbiBmdW5jdGlvbnNcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVOb3RpZmljYXRpb24odXNlcklkOiBudW1iZXIsIG5jcElkOiBzdHJpbmcsIHRpdGxlOiBzdHJpbmcsIG1lc3NhZ2U6IHN0cmluZywgdHlwZSA9IFwiaW5mb1wiKSB7XG4gIGNvbnN0IHN0bXQgPSBkYi5wcmVwYXJlKGBcbiAgICBJTlNFUlQgSU5UTyBub3RpZmljYXRpb25zICh1c2VyX2lkLCBuY3BfaWQsIHRpdGxlLCBtZXNzYWdlLCB0eXBlKVxuICAgIFZBTFVFUyAoPywgPywgPywgPywgPylcbiAgYClcblxuICBjb25zdCByZXN1bHQgPSBzdG10LnJ1bih1c2VySWQsIG5jcElkLCB0aXRsZSwgbWVzc2FnZSwgdHlwZSlcbiAgcmV0dXJuIHJlc3VsdFxufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlTm90aWZpY2F0aW9uRm9yUm9sZShyb2xlOiBzdHJpbmcsIG5jcElkOiBzdHJpbmcsIHRpdGxlOiBzdHJpbmcsIG1lc3NhZ2U6IHN0cmluZywgdHlwZSA9IFwiaW5mb1wiKSB7XG4gIGNvbnN0IHVzZXJzID0gZGIucHJlcGFyZShcIlNFTEVDVCBpZCBGUk9NIHVzZXJzIFdIRVJFIHJvbGUgPSA/XCIpLmFsbChyb2xlKVxuXG4gIGZvciAoY29uc3QgdXNlciBvZiB1c2Vycykge1xuICAgIGNyZWF0ZU5vdGlmaWNhdGlvbih1c2VyLmlkLCBuY3BJZCwgdGl0bGUsIG1lc3NhZ2UsIHR5cGUpXG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldE5vdGlmaWNhdGlvbnNGb3JVc2VyKHVzZXJJZDogbnVtYmVyLCBsaW1pdCA9IDEwKSB7XG4gIHJldHVybiBkYlxuICAgIC5wcmVwYXJlKGBcbiAgICBTRUxFQ1QgKiBGUk9NIG5vdGlmaWNhdGlvbnMgXG4gICAgV0hFUkUgdXNlcl9pZCA9ID8gXG4gICAgT1JERVIgQlkgY3JlYXRlZF9hdCBERVNDIFxuICAgIExJTUlUID9cbiAgYClcbiAgICAuYWxsKHVzZXJJZCwgbGltaXQpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRVbnJlYWROb3RpZmljYXRpb25Db3VudCh1c2VySWQ6IG51bWJlcikge1xuICBjb25zdCByZXN1bHQgPSBkYlxuICAgIC5wcmVwYXJlKFwiU0VMRUNUIENPVU5UKCopIGFzIGNvdW50IEZST00gbm90aWZpY2F0aW9ucyBXSEVSRSB1c2VyX2lkID0gPyBBTkQgaXNfcmVhZCA9IEZBTFNFXCIpXG4gICAgLmdldCh1c2VySWQpXG4gIHJldHVybiByZXN1bHQuY291bnRcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG1hcmtOb3RpZmljYXRpb25Bc1JlYWQobm90aWZpY2F0aW9uSWQ6IG51bWJlcikge1xuICByZXR1cm4gZGIucHJlcGFyZShcIlVQREFURSBub3RpZmljYXRpb25zIFNFVCBpc19yZWFkID0gVFJVRSBXSEVSRSBpZCA9ID9cIikucnVuKG5vdGlmaWNhdGlvbklkKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gbWFya0FsbE5vdGlmaWNhdGlvbnNBc1JlYWQodXNlcklkOiBudW1iZXIpIHtcbiAgcmV0dXJuIGRiLnByZXBhcmUoXCJVUERBVEUgbm90aWZpY2F0aW9ucyBTRVQgaXNfcmVhZCA9IFRSVUUgV0hFUkUgdXNlcl9pZCA9ID9cIikucnVuKHVzZXJJZClcbn1cblxuLy8gU3RhdGlzdGljcyBmdW5jdGlvbnNcbmV4cG9ydCBmdW5jdGlvbiBnZXROQ1BTdGF0aXN0aWNzKCkge1xuICBjb25zdCB0b3RhbCA9IGRiLnByZXBhcmUoXCJTRUxFQ1QgQ09VTlQoKikgYXMgY291bnQgRlJPTSBuY3BfcmVwb3J0c1wiKS5nZXQoKVxuICBjb25zdCBwZW5kaW5nID0gZGIucHJlcGFyZSgnU0VMRUNUIENPVU5UKCopIGFzIGNvdW50IEZST00gbmNwX3JlcG9ydHMgV0hFUkUgc3RhdHVzID0gXCJwZW5kaW5nXCInKS5nZXQoKVxuICBjb25zdCBxYUFwcHJvdmVkID0gZGIucHJlcGFyZSgnU0VMRUNUIENPVU5UKCopIGFzIGNvdW50IEZST00gbmNwX3JlcG9ydHMgV0hFUkUgc3RhdHVzID0gXCJxYV9hcHByb3ZlZFwiJykuZ2V0KClcbiAgY29uc3QgdGxQcm9jZXNzZWQgPSBkYi5wcmVwYXJlKCdTRUxFQ1QgQ09VTlQoKikgYXMgY291bnQgRlJPTSBuY3BfcmVwb3J0cyBXSEVSRSBzdGF0dXMgPSBcInRsX3Byb2Nlc3NlZFwiJykuZ2V0KClcbiAgY29uc3QgcmVqZWN0ZWQgPSBkYi5wcmVwYXJlKCdTRUxFQ1QgQ09VTlQoKikgYXMgY291bnQgRlJPTSBuY3BfcmVwb3J0cyBXSEVSRSBzdGF0dXMgTElLRSBcIiVyZWplY3RlZFwiJykuZ2V0KClcblxuICByZXR1cm4ge1xuICAgIHRvdGFsOiB0b3RhbC5jb3VudCxcbiAgICBwZW5kaW5nOiBwZW5kaW5nLmNvdW50LFxuICAgIHFhQXBwcm92ZWQ6IHFhQXBwcm92ZWQuY291bnQsXG4gICAgdGxQcm9jZXNzZWQ6IHRsUHJvY2Vzc2VkLmNvdW50LFxuICAgIHJlamVjdGVkOiByZWplY3RlZC5jb3VudCxcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0TkNQU3RhdGlzdGljc0ZvclJvbGUodXNlclJvbGU6IHN0cmluZywgdXNlcm5hbWU6IHN0cmluZykge1xuICBsZXQgYmFzZVF1ZXJ5ID0gXCJcIlxuICBsZXQgcGFyYW1zOiBhbnlbXSA9IFtdXG5cbiAgc3dpdGNoICh1c2VyUm9sZSkge1xuICAgIGNhc2UgXCJ1c2VyXCI6XG4gICAgICBiYXNlUXVlcnkgPSBcIkZST00gbmNwX3JlcG9ydHMgV0hFUkUgc3VibWl0dGVkX2J5ID0gP1wiXG4gICAgICBwYXJhbXMgPSBbdXNlcm5hbWVdXG4gICAgICBicmVha1xuICAgIGNhc2UgXCJxYV9sZWFkZXJcIjpcbiAgICAgIGJhc2VRdWVyeSA9IFwiRlJPTSBuY3BfcmVwb3J0c1wiXG4gICAgICBicmVha1xuICAgIGNhc2UgXCJ0ZWFtX2xlYWRlclwiOlxuICAgICAgYmFzZVF1ZXJ5ID0gXCJGUk9NIG5jcF9yZXBvcnRzIFdIRVJFIGFzc2lnbmVkX3RlYW1fbGVhZGVyID0gP1wiXG4gICAgICBwYXJhbXMgPSBbdXNlcm5hbWVdXG4gICAgICBicmVha1xuICAgIGRlZmF1bHQ6XG4gICAgICBiYXNlUXVlcnkgPSBcIkZST00gbmNwX3JlcG9ydHNcIlxuICB9XG5cbiAgY29uc3QgdG90YWwgPSBkYi5wcmVwYXJlKGBTRUxFQ1QgQ09VTlQoKikgYXMgY291bnQgJHtiYXNlUXVlcnl9YCkuZ2V0KC4uLnBhcmFtcylcbiAgY29uc3QgcGVuZGluZyA9IGRiLnByZXBhcmUoYFNFTEVDVCBDT1VOVCgqKSBhcyBjb3VudCAke2Jhc2VRdWVyeX0gQU5EIHN0YXR1cyA9ICdwZW5kaW5nJ2ApLmdldCguLi5wYXJhbXMpXG4gIGNvbnN0IGFwcHJvdmVkID0gZGIucHJlcGFyZShgU0VMRUNUIENPVU5UKCopIGFzIGNvdW50ICR7YmFzZVF1ZXJ5fSBBTkQgc3RhdHVzIExJS0UgJyVhcHByb3ZlZCdgKS5nZXQoLi4ucGFyYW1zKVxuICBjb25zdCBwcm9jZXNzZWQgPSBkYi5wcmVwYXJlKGBTRUxFQ1QgQ09VTlQoKikgYXMgY291bnQgJHtiYXNlUXVlcnl9IEFORCBzdGF0dXMgTElLRSAnJXByb2Nlc3NlZCdgKS5nZXQoLi4ucGFyYW1zKVxuXG4gIHJldHVybiB7XG4gICAgdG90YWw6IHRvdGFsLmNvdW50LFxuICAgIHBlbmRpbmc6IHBlbmRpbmcuY291bnQsXG4gICAgYXBwcm92ZWQ6IGFwcHJvdmVkLmNvdW50LFxuICAgIHByb2Nlc3NlZDogcHJvY2Vzc2VkLmNvdW50LFxuICB9XG59XG5cbi8vIFVwZGF0ZSBleGlzdGluZyByZWNvcmRzIHRvIGhhdmUgZGVmYXVsdCB2YWx1ZXMgZm9yIG5ldyBjb2x1bW5zXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlRXhpc3RpbmdSZWNvcmRzKCkge1xuICBjb25zdCB1cGRhdGVRdWVyeSA9IGBcbiAgICBVUERBVEUgbmNwX3JlcG9ydHMgU0VUIFxuICAgICAganVtbGFoX3NvcnRpciA9IENPQUxFU0NFKGp1bWxhaF9zb3J0aXIsICcwJyksXG4gICAgICBqdW1sYWhfcmVsZWFzZSA9IENPQUxFU0NFKGp1bWxhaF9yZWxlYXNlLCAnMCcpLCBcbiAgICAgIGp1bWxhaF9yZWplY3QgPSBDT0FMRVNDRShqdW1sYWhfcmVqZWN0LCAnMCcpXG4gICAgV0hFUkUganVtbGFoX3NvcnRpciBJUyBOVUxMIE9SIGp1bWxhaF9yZWxlYXNlIElTIE5VTEwgT1IganVtbGFoX3JlamVjdCBJUyBOVUxMXG4gIGBcblxuICBjb25zdCByZXN1bHQgPSBkYi5wcmVwYXJlKHVwZGF0ZVF1ZXJ5KS5ydW4oKVxuICByZXR1cm4gcmVzdWx0XG59XG5cbi8vIEluaXRpYWxpemUgZGF0YWJhc2Ugb24gaW1wb3J0XG5pbml0aWFsaXplRGF0YWJhc2UoKVxudXBkYXRlRXhpc3RpbmdSZWNvcmRzKClcblxuZXhwb3J0IHsgZGIgfVxuIl0sIm5hbWVzIjpbIkRhdGFiYXNlIiwiY29tcGFyZSIsImRiIiwiaW5pdGlhbGl6ZURhdGFiYXNlIiwidGFibGVzRXhpc3QiLCJwcmVwYXJlIiwiZ2V0IiwiZXhlYyIsImdlbmVyYXRlTkNQTnVtYmVyIiwibm93IiwiRGF0ZSIsInllYXIiLCJnZXRGdWxsWWVhciIsInRvU3RyaW5nIiwic2xpY2UiLCJtb250aCIsImdldE1vbnRoIiwicGFkU3RhcnQiLCJsYXRlc3RSZWNvcmQiLCJzZXJpYWxOdW1iZXIiLCJleGlzdGluZ1NlcmlhbCIsIm5jcF9pZCIsInNwbGl0IiwiTnVtYmVyIiwicGFyc2VJbnQiLCJmb3JtYXR0ZWRTZXJpYWwiLCJhdXRoZW50aWNhdGVVc2VyIiwidXNlcm5hbWUiLCJwYXNzd29yZCIsInVzZXIiLCJpc1ZhbGlkIiwiaWQiLCJyb2xlIiwiZnVsbE5hbWUiLCJmdWxsX25hbWUiLCJnZXRVc2VyQnlVc2VybmFtZSIsImNyZWF0ZU5DUFJlcG9ydCIsImRhdGEiLCJuY3BJZCIsInN0bXQiLCJyZXN1bHQiLCJydW4iLCJza3VDb2RlIiwibWFjaGluZUNvZGUiLCJkYXRlIiwidGltZUluY2lkZW50IiwiaG9sZFF1YW50aXR5IiwiaG9sZFF1YW50aXR5VU9NIiwicHJvYmxlbURlc2NyaXB0aW9uIiwicGhvdG9BdHRhY2htZW50IiwicWFMZWFkZXIiLCJzdWJtaXR0ZWRCeSIsImNyZWF0ZU5vdGlmaWNhdGlvbkZvclJvbGUiLCJsYXN0SW5zZXJ0Um93aWQiLCJnZXROQ1BSZXBvcnRzRm9yVXNlciIsInVzZXJJZCIsInVzZXJSb2xlIiwicXVlcnkiLCJwYXJhbXMiLCJyZXN1bHRzIiwiYWxsIiwiZ2V0UGVuZGluZ05DUHNGb3JSb2xlIiwiZ2V0TkNQQnlJZCIsImFwcHJvdmVOQ1BCeVFBTGVhZGVyIiwiYXBwcm92YWxEYXRhIiwicWFMZWFkZXJVc2VybmFtZSIsImRpc3Bvc2lzaSIsImp1bWxhaFNvcnRpciIsImp1bWxhaFJlbGVhc2UiLCJqdW1sYWhSZWplY3QiLCJhc3NpZ25lZFRlYW1MZWFkZXIiLCJjaGFuZ2VzIiwibmNwIiwidGVhbUxlYWRlclVzZXIiLCJjcmVhdGVOb3RpZmljYXRpb24iLCJyZWplY3ROQ1BCeVFBTGVhZGVyIiwicmVqZWN0aW9uUmVhc29uIiwicHJvY2Vzc05DUEJ5VGVhbUxlYWRlciIsInByb2Nlc3NEYXRhIiwidGVhbUxlYWRlclVzZXJuYW1lIiwicm9vdENhdXNlQW5hbHlzaXMiLCJjb3JyZWN0aXZlQWN0aW9uIiwicHJldmVudGl2ZUFjdGlvbiIsImFwcHJvdmVOQ1BCeVByb2Nlc3NMZWFkIiwiY29tbWVudCIsInByb2Nlc3NMZWFkVXNlcm5hbWUiLCJyZWplY3ROQ1BCeVByb2Nlc3NMZWFkIiwiYXNzaWduZWRfdGVhbV9sZWFkZXIiLCJhcHByb3ZlTkNQQnlRQU1hbmFnZXIiLCJxYU1hbmFnZXJVc2VybmFtZSIsInN1Ym1pdHRlclVzZXIiLCJzdWJtaXR0ZWRfYnkiLCJuY3BEZXRhaWxzIiwicWFfYXBwcm92ZWRfYnkiLCJxYUxlYWRlclVzZXIiLCJyZWplY3ROQ1BCeVFBTWFuYWdlciIsInRpdGxlIiwibWVzc2FnZSIsInR5cGUiLCJ1c2VycyIsImdldE5vdGlmaWNhdGlvbnNGb3JVc2VyIiwibGltaXQiLCJnZXRVbnJlYWROb3RpZmljYXRpb25Db3VudCIsImNvdW50IiwibWFya05vdGlmaWNhdGlvbkFzUmVhZCIsIm5vdGlmaWNhdGlvbklkIiwibWFya0FsbE5vdGlmaWNhdGlvbnNBc1JlYWQiLCJnZXROQ1BTdGF0aXN0aWNzIiwidG90YWwiLCJwZW5kaW5nIiwicWFBcHByb3ZlZCIsInRsUHJvY2Vzc2VkIiwicmVqZWN0ZWQiLCJnZXROQ1BTdGF0aXN0aWNzRm9yUm9sZSIsImJhc2VRdWVyeSIsImFwcHJvdmVkIiwicHJvY2Vzc2VkIiwidXBkYXRlRXhpc3RpbmdSZWNvcmRzIiwidXBkYXRlUXVlcnkiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/database.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/jose","vendor-chunks/bcryptjs"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fncp%2Flist%2Froute&page=%2Fapi%2Fncp%2Flist%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fncp%2Flist%2Froute.ts&appDir=%2Fhome%2Frunner%2Fworkspace%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Frunner%2Fworkspace&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();